<!DOCTYPE html>
<!--
 | Generated by Apache Maven Doxia Site Renderer 1.9.2 from src/site/markdown/docs/quickStart.md at 29 September 2020
 | Rendered using Apache Maven Fluido Skin 1.8
-->
<html xmlns="http://www.w3.org/1999/xhtml" lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="generator" content="Apache Maven Doxia Site Renderer 1.9.2" />
    <title>MyBatis Dynamic SQL &#x2013; MyBatis Dynamic SQL Quick Start</title>
    <link rel="stylesheet" href="../css/apache-maven-fluido-1.8.min.css" />
    <link rel="stylesheet" href="../css/site.css" />
    <link rel="stylesheet" href="../css/print.css" media="print" />
    <script src="../js/apache-maven-fluido-1.8.min.js"></script>
  </head>
  <body class="topBarDisabled">
    <div class="container-fluid">
      <header>
        <div id="banner">
          <div class="pull-left"><a href="../docs/introduction.html" id="bannerLeft"><h2>MyBatis Dynamic SQL</h2>
</a></div>
          <div class="pull-right"><a href="http://www.mybatis.org/" id="bannerRight" title="MyBatis logo"><img src="http://mybatis.github.io/images/mybatis-logo.png"  alt="MyBatis logo"/></a></div>
          <div class="clear"><hr/></div>
        </div>

        <div id="breadcrumbs">
          <ul class="breadcrumb">
        <li id="publishDate">Last Published: 29 September 2020<span class="divider">|</span>
</li>
          <li id="projectVersion">Version: 1.2.1</li>
          </ul>
        </div>
      </header>
      <div class="row-fluid">
        <header id="leftColumn" class="span2">
          <nav class="well sidebar-nav">
  <ul class="nav nav-list">
   <li class="nav-header">User's Guide</li>
    <li><a href="../docs/introduction.html" title="Introduction"><span class="none"></span>Introduction</a></li>
    <li><a href="../docs/CHANGELOG.html" title="Change Log"><span class="none"></span>Change Log</a></li>
    <li class="active"><a href="#"><span class="none"></span>Quick Start</a></li>
    <li><a href="../docs/databaseObjects.html" title="Modeling Database Objects"><span class="none"></span>Modeling Database Objects</a></li>
    <li><a href="../docs/whereClauses.html" title="WHERE Clause Support"><span class="icon-chevron-down"></span>WHERE Clause Support</a>
     <ul class="nav nav-list">
      <li><a href="../docs/conditions.html" title="WHERE Conditions"><span class="none"></span>WHERE Conditions</a></li>
     </ul></li>
    <li><a href="../docs/select.html" title="SELECT Statements"><span class="icon-chevron-down"></span>SELECT Statements</a>
     <ul class="nav nav-list">
      <li><a href="../docs/complexQueries.html" title="Complex Queries"><span class="none"></span>Complex Queries</a></li>
     </ul></li>
    <li><a href="../docs/delete.html" title="DELETE Statements"><span class="none"></span>DELETE Statements</a></li>
    <li><a href="../docs/insert.html" title="INSERT Statements"><span class="none"></span>INSERT Statements</a></li>
    <li><a href="../docs/update.html" title="UPDATE Statements"><span class="none"></span>UPDATE Statements</a></li>
    <li><a href="../docs/functions.html" title="Database Functions"><span class="none"></span>Database Functions</a></li>
    <li><a href="../docs/mybatis3.html" title="MyBatis3 Support"><span class="none"></span>MyBatis3 Support</a></li>
    <li><a href="../docs/kotlinMyBatis3.html" title="Kotlin Support for MyBatis3"><span class="none"></span>Kotlin Support for MyBatis3</a></li>
    <li><a href="../docs/spring.html" title="Spring Support"><span class="none"></span>Spring Support</a></li>
    <li><a href="../docs/kotlinSpring.html" title="Kotlin Support for Spring"><span class="none"></span>Kotlin Support for Spring</a></li>
    <li><a href="../docs/springBatch.html" title="Spring Batch Support"><span class="none"></span>Spring Batch Support</a></li>
    <li><a href="../docs/howItWorks.html" title="How it Works"><span class="none"></span>How it Works</a></li>
    <li><a href="../docs/extending.html" title="Extending the Library"><span class="none"></span>Extending the Library</a></li>
    <li><a href="../docs/codingStandards.html" title="Coding Standards"><span class="none"></span>Coding Standards</a></li>
    <li><a href="../docs/motivation.html" title="Motivation"><span class="none"></span>Motivation</a></li>
   <li class="nav-header">Project Documentation</li>
    <li><a href="../project-info.html" title="Project Information"><span class="icon-chevron-right"></span>Project Information</a></li>
    <li><a href="../project-reports.html" title="Project Reports"><span class="icon-chevron-right"></span>Project Reports</a></li>
  </ul>
          </nav>
          <div class="well sidebar-nav">
            <hr />
            <div id="poweredBy">
              <div class="clear"></div>
              <div class="clear"></div>
              <div class="clear"></div>
<a href="http://maven.apache.org/" title="Built by Maven" class="poweredBy"><img class="builtBy" alt="Built by Maven" src="../images/logos/maven-feather.png" /></a>
            </div>
          </div>
        </header>
        <main id="bodyColumn"  class="span10" >
<h1>MyBatis Dynamic SQL Quick Start</h1>
<p>Working with MyBatis Dynamic SQL requires the following steps:</p>
<ol style="list-style-type: decimal">

<li>Create table and column objects</li>
<li>(For MyBatis3) Create mappers (XML or Java Based)</li>
<li>Write and use SQL</li>
</ol>
<p>For the purposes of this discussion, we will show using the library to perform CRUD operations on this table:</p>

<div class="source">
<div class="source"><pre class="prettyprint">create table SimpleTable (
   id int not null,
   first_name varchar(30) not null,
   last_name varchar(30) not null,
   birth_date date not null, 
   employed varchar(3) not null,
   occupation varchar(30) null,
   primary key(id)
);
</pre></div></div>
<section>
<h2><a name="Defining_Tables_and_Columns"></a>Defining Tables and Columns</h2>
<p>The class <code>org.mybatis.dynamic.sql.SqlTable</code> is used to define a table. A table definition includes the actual name of the table (including schema or catalog if appropriate). A table alias can be applied in a select statement if desired.  Your table should be defined by extending the <code>SqlTable</code> class.</p>
<p>The class <code>org.mybatis.dynamic.sql.SqlColumn</code> is used to define columns for use in the library. SqlColumns should be created using the builder methods in SqlTable. A column definition includes:</p>
<ol style="list-style-type: decimal">

<li>The Java type</li>
<li>The actual column name (an alias can be applied in a select statement)</li>
<li>The JDBC type</li>
<li>(optional) The name of a type handler to use in MyBatis if the default type handler is not desired</li>
</ol>
<p>We suggest the following usage pattern to give maximum flexibility.  This pattern will allow you to use your table and columns in a &#x201c;qualified&#x201d; or &#x201c;un-qualified&#x201d; manner that looks like natural SQL. For example, in the following a column could be referred to as <code>firstName</code> or <code>simpleTable.firstName</code>.</p>

<div class="source">
<div class="source"><pre class="prettyprint">package examples.simple;

import java.sql.JDBCType;
import java.util.Date;

import org.mybatis.dynamic.sql.SqlColumn;
import org.mybatis.dynamic.sql.SqlTable;

public final class SimpleTableDynamicSqlSupport {
    public static final SimpleTable simpleTable = new SimpleTable();
    public static final SqlColumn&lt;Integer&gt; id = simpleTable.id;
    public static final SqlColumn&lt;String&gt; firstName = simpleTable.firstName;
    public static final SqlColumn&lt;String&gt; lastName = simpleTable.lastName;
    public static final SqlColumn&lt;Date&gt; birthDate = simpleTable.birthDate;
    public static final SqlColumn&lt;Boolean&gt; employed = simpleTable.employed;
    public static final SqlColumn&lt;String&gt; occupation = simpleTable.occupation;

    public static final class SimpleTable extends SqlTable {
        public final SqlColumn&lt;Integer&gt; id = column(&quot;id&quot;, JDBCType.INTEGER);
        public final SqlColumn&lt;String&gt; firstName = column(&quot;first_name&quot;, JDBCType.VARCHAR);
        public final SqlColumn&lt;String&gt; lastName = column(&quot;last_name&quot;, JDBCType.VARCHAR);
        public final SqlColumn&lt;Date&gt; birthDate = column(&quot;birth_date&quot;, JDBCType.DATE);
        public final SqlColumn&lt;Boolean&gt; employed = column(&quot;employed&quot;, JDBCType.VARCHAR, &quot;examples.simple.YesNoTypeHandler&quot;);
        public final SqlColumn&lt;String&gt; occupation = column(&quot;occupation&quot;, JDBCType.VARCHAR);

        public SimpleTable() {
            super(&quot;SimpleTable&quot;);
        }
    }
}
</pre></div></div>
</section><section>
<h2><a name="Creating_MyBatis3_Mappers"></a>Creating MyBatis3 Mappers</h2>
<p>The library will create classes that will be used as input to a MyBatis mapper.  These classes include the generated SQL, as well as a parameter set that will match the generated SQL.  Both are required by MyBatis.  It is intended that these objects be the one and only parameter to a MyBatis mapper method.</p>
<p>The library can be used with both XML and annotated mappers, but we recommend using MyBatis&#x2019; annotated mapper support in all cases.  The only case where XML is required is when you code a JOIN statement - in that case you will need to define your result map in XML due to limitations of the MyBatis annotations in supporting joins.</p>
<p>For example, a mapper might look like this:</p>

<div class="source">
<div class="source"><pre class="prettyprint">package examples.simple;

import java.util.List;

import org.apache.ibatis.annotations.DeleteProvider;
import org.apache.ibatis.annotations.InsertProvider;
import org.apache.ibatis.annotations.Mapper;
import org.apache.ibatis.annotations.Result;
import org.apache.ibatis.annotations.ResultMap;
import org.apache.ibatis.annotations.Results;
import org.apache.ibatis.annotations.SelectProvider;
import org.apache.ibatis.annotations.UpdateProvider;
import org.apache.ibatis.type.JdbcType;
import org.mybatis.dynamic.sql.delete.render.DeleteStatementProvider;
import org.mybatis.dynamic.sql.insert.render.InsertStatementProvider;
import org.mybatis.dynamic.sql.select.render.SelectStatementProvider;
import org.mybatis.dynamic.sql.update.render.UpdateStatementProvider;
import org.mybatis.dynamic.sql.util.SqlProviderAdapter;

@Mapper
public interface SimpleTableAnnotatedMapper {

    @InsertProvider(type=SqlProviderAdapter.class, method=&quot;insert&quot;)
    int insert(InsertStatementProvider&lt;SimpleTableRecord&gt; insertStatement);

    @UpdateProvider(type=SqlProviderAdapter.class, method=&quot;update&quot;)
    int update(UpdateStatementProvider updateStatement);

    @SelectProvider(type=SqlProviderAdapter.class, method=&quot;select&quot;)
    @Results(id=&quot;SimpleTableResult&quot;, value= {
            @Result(column=&quot;A_ID&quot;, property=&quot;id&quot;, jdbcType=JdbcType.INTEGER, id=true),
            @Result(column=&quot;first_name&quot;, property=&quot;firstName&quot;, jdbcType=JdbcType.VARCHAR),
            @Result(column=&quot;last_name&quot;, property=&quot;lastName&quot;, jdbcType=JdbcType.VARCHAR),
            @Result(column=&quot;birth_date&quot;, property=&quot;birthDate&quot;, jdbcType=JdbcType.DATE),
            @Result(column=&quot;employed&quot;, property=&quot;employed&quot;, jdbcType=JdbcType.VARCHAR, typeHandler=YesNoTypeHandler.class),
            @Result(column=&quot;occupation&quot;, property=&quot;occupation&quot;, jdbcType=JdbcType.VARCHAR)
    })
    List&lt;SimpleTableRecord&gt; selectMany(SelectStatementProvider selectStatement);

    @SelectProvider(type=SqlProviderAdapter.class, method=&quot;select&quot;)
    @ResultMap(&quot;SimpleTableResult&quot;)
    SimpleTableRecord selectOne(SelectStatementProvider selectStatement);

    @DeleteProvider(type=SqlProviderAdapter.class, method=&quot;delete&quot;)
    int delete(DeleteStatementProvider deleteStatement);

    @SelectProvider(type=SqlProviderAdapter.class, method=&quot;select&quot;)
    long count(SelectStatementProvider selectStatement);
}
</pre></div></div>
</section><section>
<h2><a name="Executing_SQL_with_MyBatis3"></a>Executing SQL with MyBatis3</h2>
<p>In a DAO or service class, you can use the generated statement as input to your mapper methods.  Here&#x2019;s an example from <code>examples.simple.SimpleTableAnnotatedMapperTest</code>:</p>

<div class="source">
<div class="source"><pre class="prettyprint">    @Test
    public void testSelectByExample() {
        try (SqlSession session = sqlSessionFactory.openSession()) {
            SimpleTableAnnotatedMapper mapper = session.getMapper(SimpleTableAnnotatedMapper.class);
            
            SelectStatementProvider selectStatement = select(id.as(&quot;A_ID&quot;), firstName, lastName, birthDate, employed, occupation)
                    .from(simpleTable)
                    .where(id, isEqualTo(1))
                    .or(occupation, isNull())
                    .build()
                    .render(RenderingStrategies.MYBATIS3);

            List&lt;SimpleTableRecord&gt; rows = mapper.selectMany(selectStatement);

            assertThat(rows.size()).isEqualTo(3);
        }
    }
</pre></div></div></section>
        </main>
      </div>
    </div>
    <hr/>
    <footer>
      <div class="container-fluid">
        <div class="row-fluid">
            <p>Copyright &#169;      2016&#x2013;2020<a href="https://www.mybatis.org/">MyBatis.org</a>.
.</p>
        </div>
      </div>
    </footer>
  </body>
</html>
